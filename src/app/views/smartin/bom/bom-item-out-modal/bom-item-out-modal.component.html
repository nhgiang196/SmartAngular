<div
  class="modal inmodal"
  id="modalOut"
  data-backdrop="static"
  data-keyboard="true"
  tabindex="-1"
  role="dialog"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg ">
    <div class="modal-content animated fadeIn">
      <div class="modal-header">
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          (click)="isLoadData.emit(true)"
        >
          <span aria-hidden="true">&times;</span
          ><span class="sr-only">Close</span>
        </button>
        <h4 class="modal-title">{{ "BomFactory.label.ItemOut" | translate }}</h4>
      </div>
      <div class="modal-body">
        
          <!-- table OutBomItem -->
          <div class="row">
            <div class="col-lg-12">
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th width="5%">#</th>
                    <th width="35%">
                      {{ "BomFactory.BomItemOut.ItemId" | translate }} *
                    </th>
                    <th width="35%">
                      {{ "BomFactory.BomItemOut.UnitId" | translate }} *
                    </th>
                    <th width="15%">
                      {{ "BomFactory.BomItemOut.Quantity" | translate }} *
                    </th>
                    <th width="10%">{{ "Button.Action" | translate }}</th>
                  </tr>
                </thead>
                <tbody>
                  <ng-container  *ngFor="let item of entity.BomStage[currentStageId]?.BomItemOut; let i = index">
                    <tr
                    class="animated fadeInRight"
                    *ngIf="item.Status==true || item.IsNew ==true"
                    >
                    <td>{{ i + 1 }}</td>
                    <td *ngIf="i + 1 !== editRowId">{{ item.ItemName }}</td>
                    <td *ngIf="i + 1 !== editRowId">{{ item.UnitName }}</td>
                    <td *ngIf="i + 1 !== editRowId">{{ item.Quantity }}</td>

                    <td *ngIf="i + 1 === editRowId">
                      <app-smart-select listName="ItemOut"  name="outBomItem_Item"
                      [specialId]="outBomItem.ItemId"    
                      (select_ngModel)="outBomItem.ItemId = $event.id;outBomItem.ItemName = $event.text"
                      >
                      </app-smart-select>
                    </td>
                    <td *ngIf="i + 1 === editRowId">
                      <app-smart-select name="outBomItem_PackageUnit" listName="Unit"      
                      [specialId]="outBomItem.UnitId"    
                      (select_ngModel)="outBomItem.UnitId = $event.id; outBomItem.UnitName = $event.text;">
                    </app-smart-select>

                      
                    </td>
                    <td *ngIf="i + 1 === editRowId">
                      <input
                        type="number"
                        class="form-control"
                        name="Quantity"
                        id="Quantity"
                        min="0"
                        (change)="( $event.target.value < 0 || $event.target.value == '')? outBomItem.Quantity=0: outBomItem.Quantity"
                        [(ngModel)]="outBomItem.Quantity"
                      />
                    </td>
                    <td>
                      <div class="btn-group">
                        <div class="text-nowrap">
                          <button
                            type="button"
                            class="btn btn-sm btn-outline btn-primary"
                            (click)="fnSaveOutBomItem(i)"
                            *ngIf="i + 1 === editRowId"
                          >
                            <i class="fa fa-check"></i>
                          </button>
                          <button
                            type="button"
                            class="btn btn-sm btn-outline btn-success"
                            [disabled]="editRowId != 0"
                            (click)="fnEditOutBomItem(i)"
                            *ngIf="i + 1 !== editRowId"
                          >
                            <i class="fa fa-pencil"></i>
                          </button>
                          <button
                            type="button"
                            class="btn btn-sm btn-outline btn-danger"
                            (click)="fnDeleteInBomItem(i)"
                            *ngIf="i + 1 !== editRowId"
                          >
                            <i class="fa fa-trash"></i>
                          </button>
                          <button
                            type="button"
                            class="btn btn-sm btn-outline btn-default"
                            (click)="showModalIn(i)"
                            *ngIf="i + 1 !== editRowId">
                            <i class="fa fa-plus"></i>
                          </button>
                        </div>
                      </div>
                    </td>
                  </tr>
                  </ng-container>
                  
                  <!-- new record -->
                  <tr>
                    <td>{{ bomItems.length + 1 }}</td>
                    <td>
                      <app-smart-select   
                      name="newBomItemOut_Item"  
                      listName="ItemOut"
                      [specialId]="newBomItemOut.ItemId"    
                      (select_ngModel)="newBomItemOut.ItemId = $event.id;;newBomItemOut.ItemName = $event.text;"
                      ></app-smart-select>
                    </td>
                    <td>
                      <app-smart-select 
                       name="newBomItemOut_PackageUnit" 
                       listName="Unit"  
                       [specialId]="newBomItemOut.UnitId"    
                       (select_ngModel)="newBomItemOut.UnitId = $event.id;newBomItemOut.UnitName = $event.text;"
                       ></app-smart-select>
                    </td>
                    <td>
                      <input
                        type="number"
                        class="form-control"
                        name="newQuantity"
                        id="newQuantity"
                        min="0"
                        (change)="( $event.target.value < 0 || $event.target.value == '')? newBomItemOut.Quantity=0: newBomItemOut.Quantity"
                        [(ngModel)]="newBomItemOut.Quantity"
                      />
                    </td>
                    <td>
                      <button
                        type="button"
                        class="btn  btn-sm btn-outline btn-info pull-right"
                        [disabled]="!newBomItemOut.ItemId||!newBomItemOut.UnitId ||!newBomItemOut.Quantity"
                        (click)="fnAddInBomItem()"
                      >
                        <i class="fa fa-plus"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
       
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-white"
          (click)="fnBackStageModal()"
          [disabled]="editRowId!=0"
        >
          {{ "Button.Close" | translate }}
        </button>
        <button
          type="button"
          class="btn btn-primary"
          [ladda]="laddaSubmitLoading"
          data-toggle="modal"
          data-target="#modalStages"
          data-dismiss="modal"
          (click)="fnSaveBomItemOut()"
          [disabled]="editRowId!=0"
        >
          {{ "Button.Save" | translate }}
        </button>
      </div>
    </div>
  </div>
</div>

<app-bom-item-in-modal [entity]="entity" [units]="units" [parentOutId] ="parentOutId" [currentStageId]="currentStageId" (isLoadData)="isLoadData.emit(true)"></app-bom-item-in-modal>